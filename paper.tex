\documentclass{scrartcl}
\usepackage{pgfplots}
\usepackage{tikz}
\usepackage{csquotes}
\usepackage{framed}
\usepackage{todo}
\usepackage{amsmath}
\usepackage[framed]{ntheorem}

\theoremstyle{nonumberplain}
\newframedtheorem{defi}{Definition}
\newframedtheorem{theo}{Theorem}

\newcommand{\tupel}[1]{\left(#1\right)}
\newcommand{\set}[1]{\left\{#1\right\}}

\DeclareMathOperator{\ex}{ex}

\title{Resource Buying Games}
\author{Christoph Welzel}

\begin{document}
\input{tikz/settings}
\maketitle
\section{Introduction}

\section{Congestion Model}
In this section we want to introduce a structure to model resources and demands
of actors on resources. Therefore, we consider a set of players $N$ and a set
of resources $E$. Every player has a personal aim which can be achieved by
different resources. This is modelled for a player $i\in N$ as family
$\mathcal{S}_{i}$ of sets $S_{i}\subseteq E$ of resources. Additionally, we
want to account for different demands of players on resources by fixing a
demand for every player $i$ as $d_{i}\in\mathbb{N}$. Finally, the cost of a
resource depends on the load the players put onto the resource modelled as
individual cost functions $c_{e}:\mathbb{N}\rightarrow \mathbb{R}_{+}$ for
every resource $e\in E$. As an example consider different actors that build a
shared network infrastructure. The connections in the network are resources,
the actors are the players which have individual spots they want to connect.
Different actors might need different bandwidth for connections, i.e. their
demands, and the cost for using connections depends on the used bandwidth.
Accordingly we obtain a congestion model
\begin{equation*}
  \mathcal{M} = \tupel{N, E, \mathcal{S} = \times_{i\in N}\mathcal{S}_{i},
  (d_{i})_{i\in N}, (c_{e})_{e\in E}}
\end{equation*}
for which we introduce some additional definitions:
\begin{itemize}
  \item for a profile $S\in\mathcal{S}$ we define
    the demand on resource $e$ for $S$ as
    $\ell(S) = \sum_{i\in N:e\in S_{i}}d_{i}$
  \item we lift $c_{e}$ to the set $\mathcal{S}$ by setting
    $c_{e}(S) = c_{e}(\ell_{e}(S))$ for $S\in\mathcal{S}$
  \item we call $c_{e}$ \emph{marginally non-increasing} if
    $c_{e}(y + \delta) - c_{e}(y) \leq c_{e}(x + \delta) - c_{e}(x)$ holds
    for all $x,y,\delta\in N$ with $x\leq y$
  \item analogously $c_{e}$ is \emph{marginally non-decreasing} if
    $c_{e}(y + \delta) - c_{e}(y) \geq c_{e}(x + \delta) - c_{e}(x)$ holds
    for all $x,y,\delta\in N$ with $x\leq y$
\end{itemize}
Note that linear and constant cost functions are marginally non-increasing.

The cost that results from a profile $S\in\mathcal{S}$ is covered by all
players. To model this we consider the resource buying game 
\begin{equation*}
  G = \tupel{N, \mathcal{S}\times\mathcal{P}, \pi}
\end{equation*}
where $\mathcal{P} = \times_{i\in N}\mathcal{P}_{i}$ and
$\mathcal{P}_{i} = |\mathbb{R}_{+}^{|E|}|$ to model how much every player
contributes in paying for the cost of every resource. We denote the element
from $\mathcal{P}_{i}$ for $e\in E$ with $p_{i}^{e}$ and call $e\in E$ bought
under $\tupel{S, p}\in \mathcal{S}\times\mathcal{P}$ if
$c_{e}(S)\leq \sum_{i\in N}p_{i}^{e}$. The function $\pi$ gives the payoff for
every player for a strategy profile $\tupel{S, p}$ by
\begin{equation*}
  \pi_{i}(S, p) = \begin{cases}
    \sum_{e\in E}p_{i}^{e} &\text{ if $S_{i}$ is bought under
    $\tupel{S, p}$ (i.e. all $e\in S_{i}$ are bought)}\\
    \infty &\text{ otherwise}
  \end{cases}
\end{equation*}
Thus, every player tries to minimise her personal contribution to the costs
but ensures that her demand is satisfied.
\section{Matroids}
In this section we present the combinatorial structure of Matroids.
\todo{why matroids?}

We use matroids as a generalisation of the concept of linear independence.
Matroids can be defined as a ground-set and the family of linear
independent sets of this ground-set. This family has to satisfy three
properties, i.e.
\begin{enumerate}
  \item the empty set is linear independent,
  \item all subset of a linear independent set are linear independent and
  \item for two linear independent sets we can find an element of the larger
    set that forms a linear independent set when added to the smaller set.
\end{enumerate}
We use an equivalent definition of matroids which in a way captures the idea of
bases of a vector space by giving the inclusion-wise maximal linear independent
sets (in analogy also called bases).
\begin{defi}
  The structure $\tupel{E, \mathcal{B}}$ with $\mathcal{B}\subseteq 2^{E}$ is
  a matroid if
  \begin{enumerate}
    \item $\mathcal{B}\neq\emptyset$
    \item let $B,B'\in\mathcal{B}$ and for every $x\in B$ there is $y\in B'$
      s. t. $(B\setminus\set{x})\cup\set{y}\in\mathcal{B}$
  \end{enumerate}
\end{defi}
In analogy to vector spaces we consider every element of a basis to open access
to a dimension. We illustrate this concept with the following example: given an
undirected connected graph $G = \tupel{V, E}$ we will argue that
$\tupel{E, \mathcal{S}}$ with $\mathcal{S}$ as edge-sets of spanning trees
in $G$ forms a matroid. In order to meet the requirement that $\mathcal{S}$
must not be empty we restrict $G$ to those graphs with at least two distinct
vertices. Furthermore, given two spanning trees $\tupel{V, S_{1}}$ and
$\tupel{V, S_{2}}$ of $G$ then removing an edge from $S_{1}$ yields a subgraph
of $G$ that is separated into two connected components. Since $S_{2}$ forms a
spanning tree as well there must be an edge connecting these components which
can be used to again obtain a spanning tree\footnote{see Figure
\ref{fig:spanning} for an illustration}.
\begin{figure}
  \begin{center}
    \begin{tikzpicture}
      \node (t) {\input{tikz/graphp1}};
      \node[below left=of t] {\input{tikz/graphp1S1}};
      \node[below =of t] {\input{tikz/graphp1S2}};
      \node[below right=of t] {\input{tikz/graphp1S1}};
    \end{tikzpicture}
  \end{center}
  \caption{Graph with its spanning trees.}
  \label{fig:spanning}
\end{figure}
\todo[done]{working iteratively towards a basis by kruskal's algorithm as
example to introduce cuts and contractions and deletions}
Consider the algorithm of Kruskal which computes spanning trees by iteratively
adding edges which do not close a cycle: every added edge works towards a basis
in $\mathcal{S}$ and opens a dimensionality by connecting already computed
components.  When an edge is added the result of the algorithm can only compute
certain spanning trees, namely those which contain all edges added up to this
point. Fixing certain elements in matroids and therefore restricting the set of
\enquote{useable} bases is captured by the \emph{contraction} operation on
matroids.
\begin{defi}
  For a matroid $\mathcal{M} = \tupel{E, \mathcal{B}}$ and one $e\in E$ we call
  the matroid $\tupel{E\setminus\set{e}, \set{B\subseteq
  (E\setminus\set{e})\middle| B\cup\set{e}\in\mathcal{B}}}$ the
  \emph{contraction} of $e$ in $\mathcal{M}$, denoted by $\mathcal{M}/e$.
\end{defi}
In a similar manner we introduce the \emph{deletion} operation on matroids to
disregard all bases which use a certain element.
\begin{defi}
  For a matroid $\mathcal{M} = \tupel{E, \mathcal{B}}$ and one $e\in E$ we call
  the matroid $\tupel{E\setminus\set{e}, \set{C\subseteq
  (E\setminus\set{e})\middle| B\in\mathcal{B}}}$ the \emph{deletion} of $e$ in
  $\mathcal{M}$, denoted by $\mathcal{M}\setminus e$.
\end{defi}
Note that this deletion operation is not necessarily well defined for all
elements of the ground-set, e.g. deletion of an edge in the spanning tree
matroid which is a bridge yields an empty set of bases and thus no valid
matroid. Analogously, any set of edges that, when removed, disconnect the graph
contains at least one element necessarily present in any basis. We call such
sets cuts\footnote{see Figure \ref{fig:cuts} for an illustration} and define
them as follows.
\begin{defi}
  Let $\mathcal{M} = \tupel{E, \mathcal{B}}$ be a matroid. A \emph{cut}
  $C\subseteq E$ is an inclusion-wise minimal set s.t. $E\setminus C$ does not
  contain any basis in $\mathcal{B}$.
\end{defi}
\begin{figure}
  \begin{center}
    \begin{tikzpicture}
      \node (1) {\input{tikz/graphp1Cut1}};
      \node[right=of 1] (2) {\input{tikz/graphp1Cut2}};
      \node[right=of 2] (3) {\input{tikz/graphp1Cut3}};
      \node[below=of 1] (4) {\input{tikz/graphp1Cut4}};
      \node[right=of 4] (5) {\input{tikz/graphp1Cut5}};
    \end{tikzpicture}
  \end{center}
  \caption{Cuts of the spanning tree matroid from the graph presented in Figure
    \ref{fig:spanning}.}
  \label{fig:cuts}
\end{figure}

\section{Unweighted Matroid Games with marginally non-increasing cost
functions}
We present an algorithm which computes pure Nash equilibria in unweighted
matroid games with marginally non-increasing cost functions. Firstly, an
unweighted matroid game builds upon a congestion model of the form
$\tupel{N, E, \mathcal{B} = \times_{i\in N}\mathcal{B}_{i},
(d_{i})_{i\in N}, (c_{e})_{e\in E}}$ where for all $i\in N$ holds $d_{i} = 1$
(unweighted) and every $\mathcal{B}_{i}$ is the set of bases for some matroid
$\mathcal{M}_{i} = \tupel{E_{i}, \mathcal{B}_{i}}$. The set of resources is
given by the matroids of the players $E = \bigcup_{i\in N}E_{i}$ and all cost
functions $c_{e}$ are marginally non-increasing.

The algorithm we present in the following chooses a basis for every player by
iteratively adding one element from a cut and contracting the matroid to the
added element while deleting all other elements from the cut. Since cuts are
inclusion-wise minimal deleting all but one element from one cut leaves at
least one possible basis for the player available. For every player we maintain
the elements which are chosen for her up to the current state
(\emph{working basis}) and which elements are still available to build her
basis (\emph{ground-set}) and which bases she can still use. Initially the
working basis is empty and the ground-set and available bases are taken from
the matroid of the player. For every resource we maintain the cost the next
added load causes and how much load already is placed upon the
resource(\emph{current load}). Initially for every resource $e$ the current
load is zero and the next load causes $c_{e}(1)$ cost. We can devide the
algorithm into four steps as presented in Figure \ref{alg:main}.
\begin{figure}
  \begin{tabular}{|lll|}
    \hline
    (i) & Init: &\hspace{-0.6cm}\parbox{0.8\textwidth}{
        \begin{itemize}
          \item \parbox{0.7\textwidth}{every player: empty working basis,
            complete ground-set, complete set of valid result bases}
          \item every resource: cost for next load, current load
        \end{itemize}
      }\\\hline
    (ii) & Find: &\hspace{-0.6cm}\parbox{0.8\textwidth}{
        \begin{itemize}
          \item inclusion-min (necessary cost)-max cut $C$
          \item minimal cost resource $e$ in $C$
          \item owner $i$ of $C$
        \end{itemize}
      }\\\hline
    (iii) & Pick: &\hspace{-0.6cm}\parbox{0.8\textwidth}{
        \begin{itemize}
          \item $i$: add $e$ to working basis, contract matroid to $e$
          \item $e$: update marginal cost and increase load
          \item all player: delete elements $C\setminus\set{e}$ from matroid
        \end{itemize}
      }\\\hline
    (iv) & Break: &\hspace{-0.6cm}\parbox{0.8\textwidth}{
        \begin{itemize}
          \item exists player with incomplete basis: goto (ii)
          \item otherwise: return chosen bases and payments
        \end{itemize}
      }\\\hline
  \end{tabular}
  \caption{Algorithm to compute a PNE for unweighted matroid games with
    marginally non-increasing cost functions. Note that in step (ii) only
    inclusion-wise minimal cuts are considered (specifically the one for which
    minimal cost of all elements in the cut is maximal over all considered cuts
    is chosen). Restricting the selection to inclusion-wise minimal cuts
    ensures that removing all other elements preserves possible bases for
    \emph{all} players}
  \label{alg:main}
\end{figure}
By induction on the iterations one can prove that the cost of the chosen
element in step (ii) always decreases. This is a key lemma to prove the
correctness of the algorithm. Because, if we assume to have a beneficial
alternative to the computed basis for one player there is an element with
less cost. This alternative element is not part of the selected cut since
it would be removed for all players and thus keep its marginal cost although
only elements with higher costs are removed (by choice of the element in the
cut). Furthermore, the alternative element cannot be available to the player
for which the cut is selected since both elements open the
\enquote{same dimensionality} in contradiction to choosing a cut. Thus, the
alternative element has been removed before which implies less cost in a
previous step to the iteration where the original element was chosen. This
contradicts the monotonicity of costs of considered elements through the
iterations. Thus
\begin{theo}
  The presented algorithm computes a PNE.
\end{theo}

\section{Weighted Matroid Games}
Starting from a congestion model where every player aims to buy a basis from
a certain matroid and every player puts an individual demand upon the resources
she/he uses we derive a complete characterisation of PNEs as well as show that
every socially optimal solution actually induces a PNE. Firstly, we give some
auxiliary definitions (with a profile $B\in\mathcal{B}$, a resource $e\in E$):
\begin{itemize}
  \item $N_{e}(B) = \set{i\in N\middle| e\in B_{i}}$ is the set of players
    which use resource $e$ in the profile $B$
  \item $\ex_{i}(e) = \set{f\in E\setminus\set{e}\middle|
    (B_{i}\setminus\set{e})\cup\set{f}\in\mathcal{B}_{i}}$ is the set of
    resources player $i\in N_{e}(B)$ could exchange $e$ with
  \item $F$ is the set of resources that is obligatory for any player, i.e.
    every element of $F$ is present in \emph{all} bases of one (or more) player
  \item $\Delta_{i}\tupel{B;e\rightarrow f}$ is the marginal cost player $i$
    has to pay for resource $f$ if he intends to use $f$ instead of $e$
    (we define the minimum over all resources $e$ can be exchanged with as
    $\Delta_{i}^{e}(B) = \min_{f\in\ex_{i}(e)}\Delta_{i}(B;e\rightarrow f)$)
\end{itemize}
With these definitions we can formulate the following characterisation of
PNEs which holds for all non-negative and non-decreasing cost functions.
\begin{theo}
  For a weighted matroid resource buying game $\tupel{N, E, \mathcal{B}, d, c}$
  there is a payment vector $p$ s.t. $\tupel{B\in\mathcal{B}, p}$ is a PNE
  if and only if
  \begin{equation*}
    c_{e}(B)\leq\sum_{i\in N_{e}(B)}\Delta_{i}^{e}(B) \text{ for all } e\in
    E\setminus F
  \end{equation*}
\end{theo}
The \enquote{only if} direction is easily given by the fact that the cost
of a resource is the sum of the contributions of every player for this resource
and no player has an incentive to uniliterally change to another basis of
her/his matroid. While, for the \enquote{if} direction, we let for elements in
$F$ one player for whom this resource is obligatory pay for this resource
(since she/he needs this resource to be available she/he can not choose to
uniliterally change her/his payment). For all other elements we can define the
payments as follows:
\begin{equation*}
  p_{i}^{e} = \begin{cases}
    0 &\text{ if } \sum_{j\in N_{e}(B)}\Delta_{j}^{e}(B) = 0\\
    \underbrace{
      \frac{c_{e}(B)}{\sum_{j\in N_{e}(B)}\Delta_{j}^{e}(B)}
    }_{\leq 1}\cdot\Delta_{i}^{e}(B) &\text{ otherwise}
  \end{cases}
\end{equation*}
which yields $p_{i}^{e}\leq \Delta_{i}^{e}$ for all $e\in E\setminus F$
implying a PNE.

Using this one can derive a series of inequalities to show that every socially
optimal solution satisfies the given characterisation and hence
\begin{theo}
  Every weighted matroid resource buying game with marginally non-increasing
  cost functions posses a PNE.
\end{theo}
For completeness we present - without going into details - an analogous result
for non-decreasing cost functions. Again starting from a socially optimal
configuration one can derive a pricing vector (called marginal cost pricing)
which forms with the given configuration a PNE. Especially this result is
also viable for non-matroid strategy spaces, yielding:
\begin{theo}
  Let $G$ be a weighted resource buying game with non-decreasing marginal costs
  and let $S^{\ast}$ be a socially optimal solution. Then, marginal cost
  pricing induces a PNE.
\end{theo}

\todos

\end{document}
